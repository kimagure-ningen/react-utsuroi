"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useSingletonAudioContext = void 0;
const react_1 = require("react");
const log_1 = require("../log");
const use_remotion_environment_1 = require("../use-remotion-environment");
let warned = false;
const warnOnce = (logLevel) => {
    if (warned) {
        return;
    }
    warned = true;
    // Don't pullute logs if in SSR
    if (typeof window !== 'undefined') {
        log_1.Log.warn({ logLevel, tag: null }, 'AudioContext is not supported in this browser');
    }
};
const useSingletonAudioContext = (logLevel, latencyHint) => {
    const env = (0, use_remotion_environment_1.useRemotionEnvironment)();
    const audioContext = (0, react_1.useMemo)(() => {
        if (env.isRendering) {
            return null;
        }
        if (typeof AudioContext === 'undefined') {
            warnOnce(logLevel);
            return null;
        }
        return new AudioContext({
            latencyHint,
        });
    }, [logLevel, latencyHint, env.isRendering]);
    return audioContext;
};
exports.useSingletonAudioContext = useSingletonAudioContext;
